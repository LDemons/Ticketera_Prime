{% extends 'base.html' %}

{% block title %}Ticketera · {{ titulo }}{% endblock %}

{% block content %}
    <header class="header">
        <h1 class="page-title">{{ titulo }}</h1>
        <div class="filters">
            <a href="{% url 'usuarios_list' %}" class="btn-link">← Volver a la lista</a>
        </div>
    </header>

    <main style="padding: 16px; display: flex; justify-content: center;">
        <section class="card" style="max-width: 600px; width: 100%;">
            <div class="card-head">
                <h2>{{ titulo }}</h2>
            </div>
            <form method="POST" style="padding: 20px;">
                {% csrf_token %}
                
                {% if form.non_field_errors %}
                    <div style="background: #ffebee; border: 1px solid #ef9a9a; padding: 12px; border-radius: 8px; margin-bottom: 15px; color: #c62828;">
                        {{ form.non_field_errors }}
                    </div>
                {% endif %}

                <!-- RUT y DV -->
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label for="{{ form.rut.id_for_label }}" style="display: block; margin-bottom: 5px; font-weight: 600;">
                            {{ form.rut.label }}
                        </label>
                        {{ form.rut }}
                        {% if form.rut.errors %}
                            <small style="color: var(--red); display: block; margin-top: 5px;">{{ form.rut.errors|first }}</small>
                        {% endif %}
                    </div>
                    <div>
                        <label for="{{ form.dv.id_for_label }}" style="display: block; margin-bottom: 5px; font-weight: 600;">
                            {{ form.dv.label }}
                        </label>
                        <div class="select" style="width: 100%;">
                            {{ form.dv }}
                        </div>
                        {% if form.dv.errors %}
                            <small style="color: var(--red); display: block; margin-top: 5px;">{{ form.dv.errors|first }}</small>
                        {% endif %}
                    </div>
                </div>

                <!-- Nombre -->
                <div style="margin-bottom: 15px;">
                    <label for="{{ form.nombre.id_for_label }}" style="display: block; margin-bottom: 5px; font-weight: 600;">
                        {{ form.nombre.label }}
                    </label>
                    {{ form.nombre }}
                    {% if form.nombre.errors %}
                        <small style="color: var(--red); display: block; margin-top: 5px;">{{ form.nombre.errors|first }}</small>
                    {% endif %}
                </div>

                <!-- Email -->
                <div style="margin-bottom: 15px;">
                    <label for="{{ form.email.id_for_label }}" style="display: block; margin-bottom: 5px; font-weight: 600;">
                        {{ form.email.label }}
                    </label>
                    {{ form.email }}
                    {% if form.email.errors %}
                        <small style="color: var(--red); display: block; margin-top: 5px;">{{ form.email.errors|first }}</small>
                    {% endif %}
                </div>

                <!-- Rol -->
                <div style="margin-bottom: 15px;">
                    <label for="{{ form.rol.id_for_label }}" style="display: block; margin-bottom: 5px; font-weight: 600;">
                        {{ form.rol.label }}
                    </label>
                    <div class="select" style="width: 100%;">
                        {{ form.rol }}
                    </div>
                    {% if form.rol.errors %}
                        <small style="color: var(--red); display: block; margin-top: 5px;">{{ form.rol.errors|first }}</small>
                    {% endif %}
                </div>

                <!-- Contraseña -->
                <div style="margin-bottom: 15px;">
                    <label for="{{ form.contrasenia.id_for_label }}" style="display: block; margin-bottom: 5px; font-weight: 600;">
                        {{ form.contrasenia.label }}
                    </label>
                    {{ form.contrasenia }}
                    <small style="color: var(--muted); display: block; margin-top: 5px;">{{ form.contrasenia.help_text }}</small>
                    {% if form.contrasenia.errors %}
                        <small style="color: var(--red); display: block; margin-top: 5px;">{{ form.contrasenia.errors|first }}</small>
                    {% endif %}
                </div>

                <!-- Confirmar Contraseña -->
                <div style="margin-bottom: 15px;">
                    <label for="{{ form.confirmar_contrasenia.id_for_label }}" style="display: block; margin-bottom: 5px; font-weight: 600;">
                        {{ form.confirmar_contrasenia.label }}
                    </label>
                    {{ form.confirmar_contrasenia }}
                    {% if form.confirmar_contrasenia.errors %}
                        <small style="color: var(--red); display: block; margin-top: 5px;">{{ form.confirmar_contrasenia.errors|first }}</small>
                    {% endif %}
                </div>

                <!-- Activo -->
                <div style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    {{ form.activo }}
                    <label for="{{ form.activo.id_for_label }}" style="font-weight: 600;">
                        {{ form.activo.label }}
                    </label>
                    {% if form.activo.errors %}
                        <small style="color: var(--red); display: block; margin-top: 5px;">{{ form.activo.errors|first }}</small>
                    {% endif %}
                </div>

                <!-- Botones -->
                <div style="display: flex; gap: 10px;">
                    <button type="submit" class="btn-link" style="background: var(--indigo-800); color: #fff; flex: 1;">
                        {{ boton_texto }}
                    </button>
                    <a href="{% url 'usuarios_list' %}" class="btn-link" style="flex: 1; text-align: center;">
                        Cancelar
                    </a>
                </div>
            </form>
        </section>
    </main>
{% endblock %}